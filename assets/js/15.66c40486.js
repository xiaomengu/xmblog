(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{343:function(s,n,a){"use strict";a.r(n);var t=a(3),e=Object(t.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"前端vue项目打包部署-nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#前端vue项目打包部署-nginx"}},[s._v("#")]),s._v(" 前端Vue项目打包部署(Nginx)")]),s._v(" "),n("p",[s._v("原文链接：https://zhuanlan.zhihu.com/p/431796992")]),s._v(" "),n("h2",{attrs:{id:"_1-准备工作"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1-准备工作"}},[s._v("#")]),s._v(" 1.准备工作")]),s._v(" "),n("ul",[n("li",[s._v("完整的Vue项目")]),s._v(" "),n("li",[s._v("一台服务器")])]),s._v(" "),n("p",[s._v("准备工作很简单，只需要一个项目和一台服务器即可，项目甚至可以只是一个html文件。")]),s._v(" "),n("h2",{attrs:{id:"_2-服务器安装nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-服务器安装nginx"}},[s._v("#")]),s._v(" 2.服务器安装Nginx")]),s._v(" "),n("p",[s._v("nginx是一款轻量级的Web服务器、反向代理服务器，由于它的内存占用少，启动极快，高并发能力强，在互联网项目中广泛应用，我们的网站部署到Nginx服务器上。当然也可以选择其它web服务器，这里我们就使用主流的Nginx。")]),s._v(" "),n("p",[s._v("以Centos为例。")]),s._v(" "),n("p",[s._v("​\t看是否自带yum源")]),s._v(" "),n("p",[s._v("​\t没有的话先配置yum源")]),s._v(" "),n("p",[n("strong",[s._v("（阿里云yum源）")])]),s._v(" "),n("div",{staticClass:"language-shell line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）安装wget\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum install -y wget")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 备份/etc/yum.repos.d/CentOS-Base.repo文件\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost ~"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /etc/yum.repos.d/")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost yum.repos.d"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mv CentOS-Base.repo CentOS-Base.repo.back20190401")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 下载阿里云的Centos-6.repo文件\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost yum.repos.d"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-6.repo")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost yum.repos.d"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget -O CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo")]),s._v("\n"),n("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 重新加载yum\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost yum.repos.d"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum clean all")]),s._v("\nLoaded plugins: fastestmirror, refresh-packagekit, security\nCleaning repos: base extras updates\nCleaning up Everything\nCleaning up list of fastest mirrors\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@localhost yum.repos.d"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),n("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum makecache")]),s._v("\nLoaded plugins: fastestmirror, refresh-packagekit, security\nDetermining fastest mirrors\n * base: mirrors.aliyun.com\n * extras: mirrors.aliyun.com\n * updates: mirrors.aliyun.com\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br")])]),n("p",[s._v("输入"),n("code",[s._v("yum list | grep nginx")]),s._v(" 可以查看yum版本\n执行"),n("code",[s._v("yum install nginx")]),s._v(" 安装完毕。\n执行"),n("code",[s._v("nginx -v")]),s._v(" 即可看到安装的版本")]),s._v(" "),n("p",[n("strong",[s._v("（1）先查看服务器是否有nginx")])]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("whereis nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("如果出现如下界面，则代表未安装nginx")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu1.png",alt:"image"}})]),s._v(" "),n("p",[n("strong",[s._v("（2）安装nginx")])]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("yum install -y nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("如果未配置yum源的，可参考网上如何使用yum安装nginx，出现如下界面则代表安装完成。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu2.png",alt:"image"}})]),s._v(" "),n("p",[n("strong",[s._v("（3）查看nginx安装目录")])]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("whereis nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu3.png",alt:"image"}})]),s._v(" "),n("p",[s._v("或者使用命令查看nginx版本号，出现版本号也代表安装成功。")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("nginx -V\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("如果不能全局使用nginx指令，那么可能是环境变量没有配置，具体配置方法可参考网上。")]),s._v(" "),n("h2",{attrs:{id:"_3-启动nginx"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_3-启动nginx"}},[s._v("#")]),s._v(" 3.启动nginx")]),s._v(" "),n("p",[n("strong",[s._v("（1）启动")])]),s._v(" "),n("p",[s._v("服务器安装号nginx后，我们尝试启动它")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("直接输入nginx即可启动服务，打开浏览器，访问服务器地址，出现如下界面则代表启动成功。")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu4.png",alt:"image-"}})]),s._v(" "),n("p",[s._v("这里访问默认的是80端口，因为nginx服务就是默认的80端口，如果不能访问，大致有几种原因：")]),s._v(" "),n("ul",[n("li",[s._v("nginx未启动")]),s._v(" "),n("li",[s._v("服务器安全组未加入80端口")]),s._v(" "),n("li",[s._v("nginx配置错误")])]),s._v(" "),n("p",[n("strong",[s._v("（2）停止")])]),s._v(" "),n("p",[s._v("停止nginx服务，命令如下：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("nginx -s stop\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("（3）重启")])]),s._v(" "),n("p",[s._v("重启nginx服务，一般用于修改配置文件之后，命令如下：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("nginx -s reload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("h2",{attrs:{id:"_4-修改nginx配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4-修改nginx配置"}},[s._v("#")]),s._v(" 4.修改nginx配置")]),s._v(" "),n("p",[s._v("找到nginx配置文件存放位置，命令如下：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("whereis nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("或者")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("find / | grep nginx.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu5.png",alt:"image"}})]),s._v(" "),n("p",[s._v("此时/etc/nginx则是nginx配置文件存放位置，进入该文件夹：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("cd /etc/nginx\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("nginx.conf则是默认配置文件，编辑该文件：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("vim nginx.conf\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("我们基本上不用改什么，重要的是"),n("strong",[s._v("server")]),s._v("这个对象，默认监听的是80端口，所以我们直接访问服务器ip即可，接下来我们改为9000端口")]),s._v(" "),n("p",[s._v("重启nginx，命令如下：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("nginx -s reload\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("此时访问时则需要带上端口号（需要服务器安全组开启9000端口）")]),s._v(" "),n("p",[s._v("root字段，该字段后面跟着的就是网站页面路径，也就是网站存放的路径。")]),s._v(" "),n("p",[s._v("假设我们网站的存放路径为：")]),s._v(" "),n("div",{staticClass:"language-tex line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-tex"}},[n("code",[s._v("/home/www/dist\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("修改root，结果如下：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu6.png",alt:"image"}})]),s._v(" "),n("p",[s._v("这个时候重启nginx，我们的网站无法访问了，因为我们没有这个文件夹。")]),s._v(" "),n("h2",{attrs:{id:"_5-新建网站文件夹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_5-新建网站文件夹"}},[s._v("#")]),s._v(" 5.新建网站文件夹")]),s._v(" "),n("p",[s._v("此时我们需要在服务器上新建www文件夹：")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("cd /home\nmkdir www\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br")])]),n("p",[n("img",{attrs:{src:"https://xiaomengu.github.io/xmblog/img/bushu7.png",alt:"image"}})]),s._v(" "),n("p",[s._v("我们没有新建dist文件夹，因为我们待会儿vue项目打包就会生成dist文件夹。")]),s._v(" "),n("h2",{attrs:{id:"_6-打包部署vue项目"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_6-打包部署vue项目"}},[s._v("#")]),s._v(" 6.打包部署vue项目")]),s._v(" "),n("p",[n("strong",[s._v("（1）打包网站")])]),s._v(" "),n("p",[s._v("使用vue打包命令,生成dist文件夹：")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("npm run build\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[n("strong",[s._v("（2）上传至服务器")])]),s._v(" "),n("p",[s._v("我们可以"),n("strong",[s._v("使用ftp工具")]),s._v("将dist文件夹上传至/home/www目录下，当然也可以使用命令")]),s._v(" "),n("p",[s._v("在我们的项目目录下用打开"),n("strong",[s._v("git命令行")]),s._v("，将本地的dist整个文件夹复制到服务器，需要注意的是scp命令window不支持，所以使用了git命令行工具。")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("scp -r dist/ root@139.9.219.136:/home/www\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br")])]),n("p",[s._v("139.9.219.136为服务器域名")]),s._v(" "),n("p",[s._v("此时无需重启nginx，刷新浏览器，可以看到我们的网站已经部署成功了。139.9.219.136:9000")]),s._v(" "),n("h2",{attrs:{id:"_7-解决刷新路由404问题"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_7-解决刷新路由404问题"}},[s._v("#")]),s._v(" 7.解决刷新路由404问题")]),s._v(" "),n("p",[s._v("当我们切换路由后，然后在刷新页面，会出现404的情况。")]),s._v(" "),n("p",[s._v("这是因为我们vue项目采用了"),n("strong",[s._v("history")]),s._v("的路由方式，至于原因主要是vue是单页面应用")]),s._v(" "),n("p",[s._v("解决问题的办法：")]),s._v(" "),n("p",[s._v("（1）将路由模式改为hash")]),s._v(" "),n("p",[s._v("（2）或者修改nginx配置：")]),s._v(" "),n("div",{staticClass:"language-text line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("location / {\n  try_files $uri $uri/ /index.html; ---解决页面刷新404问题\n}　\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br")])]),n("p",[s._v("修改之后重启nginx，这个时候刷新浏览器则不会出现404了。")])])}),[],!1,null,null,null);n.default=e.exports}}]);